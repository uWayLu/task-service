# æž¶æ§‹é·ç§»èªªæ˜Ž

## ðŸŽ¯ å·²å®Œæˆçš„æ”¹è®Š

ä½ çš„å°ˆæ¡ˆå·²ç¶“å‡ç´šç‚º **æ¨¡çµ„åŒ– Blueprint æž¶æ§‹**ï¼Œå¯ä»¥è¼•é¬†æ“´å±•æ–°åŠŸèƒ½ï¼

### ä¹‹å‰ï¼ˆå–®æª”æ¡ˆï¼‰

```
app.py (164 è¡Œ)
â”œâ”€â”€ æ‰€æœ‰è·¯ç”±å¯«åœ¨ä¸€å€‹æª”æ¡ˆ
â””â”€â”€ é›£ä»¥ç®¡ç†å’Œæ“´å±•
```

### ç¾åœ¨ï¼ˆæ¨¡çµ„åŒ–ï¼‰

```
app.py (ä¸»ç¨‹å¼ï¼Œ136 è¡Œ)
â””â”€â”€ api/ (Blueprint æ¨¡çµ„)
    â”œâ”€â”€ __init__.py      (Blueprint è¨»å†Š)
    â”œâ”€â”€ health.py        (å¥åº·æª¢æŸ¥è·¯ç”±)
    â”œâ”€â”€ webhook.py       (Webhook è·¯ç”±)
    â””â”€â”€ document.py      (æ–‡ä»¶ç®¡ç†è·¯ç”±)
```

## âœ… æª”æ¡ˆè®Šæ›´

| æª”æ¡ˆ | ç‹€æ…‹ | èªªæ˜Ž |
|------|------|------|
| `app.py` | âœï¸ å·²æ›´æ–° | æ”¹ç‚ºä½¿ç”¨ Blueprint æž¶æ§‹ |
| `app_simple.py` | âœ¨ æ–°å¢ž | å‚™ä»½çš„å–®æª”æ¡ˆç‰ˆæœ¬ |
| `app_modular.py` | âŒ å·²åˆªé™¤ | å·²æ•´åˆé€² `app.py` |
| `api/` è³‡æ–™å¤¾ | âœ… æ­£å¸¸ä½¿ç”¨ | æ‰€æœ‰è·¯ç”±éƒ½åœ¨é€™è£¡ |
| `HOW_TO_ADD_API.md` | âœ¨ æ–°å¢ž | å®Œæ•´çš„æ–°å¢ž API æ•™å­¸ |

## ðŸš€ å¦‚ä½•ä½¿ç”¨

### å•Ÿå‹•æœå‹™ï¼ˆä¸è®Šï¼‰

```bash
python app.py
# æˆ–
./run.sh
```

### æ¸¬è©¦ API

```bash
# æ ¹è·¯å¾‘ - é¡¯ç¤ºæ‰€æœ‰ç«¯é»ž
curl http://localhost:12345/

# å¥åº·æª¢æŸ¥
curl http://localhost:12345/api/health

# Webhook
curl -X POST http://localhost:12345/api/webhook/gmail \
  -F "file=@test.pdf" \
  -F "document_type=bank_statement"

# æ–‡ä»¶é¡žåž‹åˆ—è¡¨
curl http://localhost:12345/api/documents/types
```

## ðŸ“ æ–°å¢ž APIï¼ˆè¶…ç°¡å–®ï¼‰

### 3 æ­¥é©Ÿæ–°å¢žåŠŸèƒ½

**æ­¥é©Ÿ 1ï¼šå»ºç«‹è·¯ç”±æª”æ¡ˆ**

```bash
# å»ºç«‹æ–°æª”æ¡ˆ
cat > api/reports.py << 'EOF'
from flask import jsonify
from . import api_bp

@api_bp.route('/reports', methods=['GET'])
def list_reports():
    return jsonify({'reports': []})
EOF
```

**æ­¥é©Ÿ 2ï¼šè¨»å†Šè·¯ç”±**

ç·¨è¼¯ `api/__init__.py`ï¼ŒåŠ å…¥ä¸€è¡Œï¼š

```python
from . import reports  # â† åŠ é€™è¡Œ
```

**æ­¥é©Ÿ 3ï¼šæ¸¬è©¦**

```bash
curl http://localhost:12345/api/reports
```

å°±é€™æ¨£ï¼ðŸŽ‰

## ðŸ“š è©³ç´°æ•™å­¸

æŸ¥çœ‹ `HOW_TO_ADD_API.md` ç²å¾—ï¼š
- âœ… å®Œæ•´ç¯„ä¾‹ï¼ˆCRUDã€æª”æ¡ˆä¸Šå‚³ã€èªè­‰ç­‰ï¼‰
- âœ… æœ€ä½³å¯¦è¸
- âœ… éŒ¯èª¤è™•ç†
- âœ… é€²éšŽæŠ€å·§

## ðŸ”„ å¦‚æžœæƒ³å›žåˆ°å–®æª”æ¡ˆç‰ˆæœ¬

æ²’å•é¡Œï¼æˆ‘å€‘ä¿ç•™äº†å‚™ä»½ï¼š

```bash
# æ¢å¾©å–®æª”æ¡ˆç‰ˆæœ¬
cp app_simple.py app.py

# åˆªé™¤ api/ è³‡æ–™å¤¾ï¼ˆå¦‚æžœä¸éœ€è¦ï¼‰
rm -rf api/
```

ä½†å»ºè­°ä¿æŒæ¨¡çµ„åŒ–æž¶æ§‹ï¼Œæœªä¾†æ“´å±•æœƒæ›´å®¹æ˜“ï¼

## ðŸ“Š æž¶æ§‹å°æ¯”

### å–®æª”æ¡ˆæž¶æ§‹
```python
# app.py
@app.route('/api/health')
def health():
    pass

@app.route('/api/webhook/gmail')
def webhook():
    pass

@app.route('/api/reports')  # æ–°åŠŸèƒ½
def reports():
    pass

# éš¨è‘—åŠŸèƒ½å¢žåŠ ï¼Œæª”æ¡ˆè¶Šä¾†è¶Šå¤§...
```

### æ¨¡çµ„åŒ–æž¶æ§‹ï¼ˆç¾åœ¨ï¼‰
```python
# app.py
from api import api_bp
app.register_blueprint(api_bp)

# api/health.py
@api_bp.route('/health')
def health():
    pass

# api/webhook.py
@api_bp.route('/webhook/gmail')
def webhook():
    pass

# api/reports.py  # æ–°åŠŸèƒ½ç¨ç«‹æª”æ¡ˆ
@api_bp.route('/reports')
def reports():
    pass
```

## âœ¨ å„ªå‹¢

1. **æ¸…æ™°çš„çµæ§‹** - æ¯å€‹åŠŸèƒ½ç¨ç«‹æª”æ¡ˆ
2. **æ˜“æ–¼ç¶­è­·** - ä¿®æ”¹ä¸å½±éŸ¿å…¶ä»–åŠŸèƒ½
3. **åœ˜éšŠå”ä½œ** - å¤šäººå¯åŒæ™‚é–‹ç™¼ä¸åŒæ¨¡çµ„
4. **æ˜“æ–¼æ¸¬è©¦** - å¯å–®ç¨æ¸¬è©¦æ¯å€‹æ¨¡çµ„
5. **é ç•™æ“´å±•** - æ–°å¢žåŠŸèƒ½åªéœ€ 2 æ­¥é©Ÿ

## ðŸŽ¯ ä¸‹ä¸€æ­¥

ä½ ç¾åœ¨å¯ä»¥ï¼š

1. âœ… ç›´æŽ¥ä½¿ç”¨ç¾æœ‰ APIï¼ˆåŠŸèƒ½å®Œå…¨ç›¸åŒï¼‰
2. âœ… æŸ¥çœ‹ `HOW_TO_ADD_API.md` å­¸ç¿’æ–°å¢žåŠŸèƒ½
3. âœ… æŸ¥çœ‹ `api/webhook.py` ä½œç‚ºç¯„ä¾‹
4. âœ… é–‹å§‹æ–°å¢žä½ éœ€è¦çš„åŠŸèƒ½ï¼

## â“ å¸¸è¦‹å•é¡Œ

**Q: åŽŸæœ‰åŠŸèƒ½é‚„èƒ½ç”¨å—Žï¼Ÿ**  
A: å®Œå…¨å¯ä»¥ï¼æ‰€æœ‰ API ç«¯é»žå®Œå…¨ç›¸åŒï¼Œåªæ˜¯å…§éƒ¨çµæ§‹æ”¹è®Šã€‚

**Q: éœ€è¦æ”¹å‹•éƒ¨ç½²é…ç½®å—Žï¼Ÿ**  
A: ä¸éœ€è¦ï¼ä»ç„¶æ˜¯ `python app.py` å•Ÿå‹•ã€‚

**Q: Docker é‚„èƒ½ç”¨å—Žï¼Ÿ**  
A: å¯ä»¥ï¼`docker-compose up -d` ç…§å¸¸ä½¿ç”¨ã€‚

**Q: å¦‚æžœé‡åˆ°å•é¡Œæ€Žéº¼è¾¦ï¼Ÿ**  
A: å¯ä»¥éš¨æ™‚ç”¨ `cp app_simple.py app.py` å›žåˆ°å–®æª”æ¡ˆç‰ˆæœ¬ã€‚

---

**ç¸½çµ**ï¼šä½ çš„å°ˆæ¡ˆå·²ç¶“æº–å‚™å¥½æœªä¾†çš„æ“´å±•äº†ï¼ðŸš€

