# æª”æ¡ˆçµ„ç¹”æŒ‡å—

æœ¬æ–‡ä»¶èªªæ˜å°ˆæ¡ˆä¸­å„ç¨®æª”æ¡ˆæ‡‰è©²æ”¾åœ¨å“ªè£¡ã€‚

## ğŸ“ å®Œæ•´ç›®éŒ„çµæ§‹

```
task-service/
â”‚
â”œâ”€â”€ app.py                    # ä¸»ç¨‹å¼
â”œâ”€â”€ config.py                 # é…ç½®æª”æ¡ˆ
â”œâ”€â”€ requirements.txt          # Python ä¾è³´
â”œâ”€â”€ .env                      # ç’°å¢ƒè®Šæ•¸ï¼ˆä¸æäº¤ï¼‰
â”œâ”€â”€ .gitignore               # Git å¿½ç•¥æ¸…å–®
â”œâ”€â”€ run.sh                    # å•Ÿå‹•è…³æœ¬
â”‚
â”œâ”€â”€ api/                      # API è·¯ç”±æ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ health.py
â”‚   â”œâ”€â”€ webhook.py
â”‚   â”œâ”€â”€ document.py
â”‚   â””â”€â”€ test.py
â”‚
â”œâ”€â”€ utils/                    # å·¥å…·æ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ pdf_parser.py
â”‚   â””â”€â”€ document_processor.py
â”‚
â”œâ”€â”€ docs/                     # ğŸ“š æ–‡ä»¶
â”‚   â”œâ”€â”€ README.md            # æ–‡ä»¶å°è¦½
â”‚   â”œâ”€â”€ QUICKSTART.md        # å¿«é€Ÿé–‹å§‹
â”‚   â”œâ”€â”€ HOW_TO_ADD_API.md   # API é–‹ç™¼æŒ‡å—
â”‚   â”œâ”€â”€ DEPLOYMENT.md        # éƒ¨ç½²æŒ‡å—
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ examples/                 # ğŸ“ ç¯„ä¾‹ç¨‹å¼ç¢¼
â”‚   â”œâ”€â”€ gmail_webhook.gs     # Apps Script ç¯„ä¾‹
â”‚   â””â”€â”€ test_samples.md      # æ¸¬è©¦ç¯„ä¾‹èªªæ˜
â”‚
â”œâ”€â”€ test_files/              # ğŸ§ª æ¸¬è©¦ç”¨ PDFï¼ˆä¸æäº¤çœŸå¯¦è³‡æ–™ï¼‰
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ bank_statement_sample.pdf
â”‚   â”œâ”€â”€ credit_card_sample.pdf
â”‚   â””â”€â”€ edge_cases/
â”‚
â”œâ”€â”€ data/                     # ğŸ’¾ è³‡æ–™å„²å­˜ï¼ˆä¸æäº¤ï¼‰
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ processed/           # è™•ç†å¾Œçš„çµæœ
â”‚   â”œâ”€â”€ cache/               # å¿«å–
â”‚   â”œâ”€â”€ config/              # è¨­å®šæª”
â”‚   â””â”€â”€ stats/               # çµ±è¨ˆè³‡æ–™
â”‚
â”œâ”€â”€ output/                   # ğŸ“Š è¼¸å‡ºçµæœï¼ˆä¸æäº¤ï¼‰
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ test_results/        # æ¸¬è©¦çµæœ
â”‚   â””â”€â”€ reports/             # å ±è¡¨
â”‚
â”œâ”€â”€ uploads/                  # â¬†ï¸ æš«å­˜ä¸Šå‚³æª”æ¡ˆï¼ˆè‡ªå‹•æ¸…ç†ï¼‰
â”‚   â””â”€â”€ .gitkeep
â”‚
â”œâ”€â”€ logs/                     # ğŸ“‹ æ—¥èªŒæª”æ¡ˆï¼ˆä¸æäº¤ï¼‰
â”‚   â””â”€â”€ app.log
â”‚
â”œâ”€â”€ scripts/                  # ğŸ”§ å·¥å…·è…³æœ¬
â”‚   â”œâ”€â”€ generate_test_pdf.py
â”‚   â””â”€â”€ batch_test.sh
â”‚
â”œâ”€â”€ tests/                    # âœ… å–®å…ƒæ¸¬è©¦
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_pdf_parser.py
â”‚   â””â”€â”€ test_document_processor.py
â”‚
â”œâ”€â”€ venv/                     # ğŸ è™›æ“¬ç’°å¢ƒï¼ˆä¸æäº¤ï¼‰
â”‚
â””â”€â”€ docker/                   # ğŸ³ Docker ç›¸é—œ
    â”œâ”€â”€ Dockerfile
    â””â”€â”€ docker-compose.yml
```

## ğŸ“‚ å„ç›®éŒ„ç”¨é€”èªªæ˜

### 1. `test_files/` - æ¸¬è©¦æª”æ¡ˆ ğŸ§ª

**ç”¨é€”ï¼š** é–‹ç™¼å’Œæ¸¬è©¦æ™‚ä½¿ç”¨çš„ PDF ç¯„ä¾‹

**æ”¾ä»€éº¼ï¼š**
- âœ… è„«æ•çš„æ¸¬è©¦ PDF
- âœ… å„ç¨®æ ¼å¼çš„ç¯„ä¾‹æª”æ¡ˆ
- âœ… é‚Šç•Œæ¸¬è©¦æ¡ˆä¾‹

**ä¸æ”¾ä»€éº¼ï¼š**
- âŒ çœŸå¯¦çš„å€‹äººè²¡å‹™è³‡æ–™
- âŒ è¶…é 5MB çš„å¤§æª”æ¡ˆ
- âŒ è‡¨æ™‚æ¸¬è©¦æª”æ¡ˆ

**å‘½åç¯„ä¾‹ï¼š**
```
bank_ctbc_statement_202411.pdf
credit_card_fubon_202411.pdf
transaction_notice_sample.pdf
edge_case_empty.pdf
```

### 2. `data/` - è³‡æ–™å„²å­˜ ğŸ’¾

**ç”¨é€”ï¼š** æŒä¹…åŒ–è³‡æ–™å’Œè™•ç†çµæœ

**å­ç›®éŒ„ï¼š**
- `data/processed/` - è™•ç†å¾Œçš„ JSON çµæœ
- `data/cache/` - å¿«å–è³‡æ–™
- `data/config/` - è¨­å®šæª”æ¡ˆï¼ˆJSON/YAMLï¼‰
- `data/stats/` - çµ±è¨ˆè³‡æ–™

**ç‰ˆæœ¬æ§åˆ¶ï¼š**
- æ•´å€‹ `data/` ç›®éŒ„è¢« `.gitignore` å¿½ç•¥
- å¦‚éœ€æäº¤è¨­å®šæª”ï¼Œä½¿ç”¨ `git add -f data/config/xxx.json`

### 3. `output/` - è¼¸å‡ºçµæœ ğŸ“Š

**ç”¨é€”ï¼š** æ¸¬è©¦è¼¸å‡ºå’Œè‡¨æ™‚çµæœ

**ç‰¹é»ï¼š**
- å¯éš¨æ™‚åˆªé™¤
- ä¸åŒ…å«åœ¨ç‰ˆæœ¬æ§åˆ¶ä¸­
- ç”¨æ–¼é™¤éŒ¯å’Œæ¸¬è©¦

**ä½¿ç”¨ç¯„ä¾‹ï¼š**
```bash
# æ¸¬è©¦ä¸¦å„²å­˜çµæœ
python test_pdf_parser.py test_files/bank.pdf \
  --output output/test_results/result.json
```

### 4. `uploads/` - æš«å­˜ä¸Šå‚³ â¬†ï¸

**ç”¨é€”ï¼š** API æ¥æ”¶çš„ PDF æª”æ¡ˆæš«å­˜

**ç‰¹é»ï¼š**
- è™•ç†å®Œè‡ªå‹•åˆªé™¤ï¼ˆå¯è¨­å®šï¼‰
- ä¸æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
- åªä¿ç•™ `.gitkeep` ç¢ºä¿ç›®éŒ„å­˜åœ¨

**æ³¨æ„äº‹é …ï¼š**
- æª”æ¡ˆåªå­˜åœ¨æ•¸ç§’åˆ°æ•¸åˆ†é˜
- å®šæœŸæ¸…ç†éºç•™æª”æ¡ˆ

### 5. `logs/` - æ—¥èªŒæª”æ¡ˆ ğŸ“‹

**ç”¨é€”ï¼š** æ‡‰ç”¨ç¨‹å¼æ—¥èªŒ

**å»ºè­°çµæ§‹ï¼š**
```
logs/
â”œâ”€â”€ app.log              # ä¸»è¦æ—¥èªŒ
â”œâ”€â”€ error.log            # éŒ¯èª¤æ—¥èªŒ
â””â”€â”€ access.log           # å­˜å–æ—¥èªŒ
```

**æ—¥èªŒè¼ªæ›ï¼š**
```python
# åœ¨ app.py ä¸­é…ç½®
from logging.handlers import RotatingFileHandler

handler = RotatingFileHandler(
    'logs/app.log',
    maxBytes=10485760,  # 10MB
    backupCount=10
)
```

### 6. `docs/` - æ–‡ä»¶ ğŸ“š

**ç”¨é€”ï¼š** æ‰€æœ‰å°ˆæ¡ˆæ–‡ä»¶

**çµ„ç¹”åŸå‰‡ï¼š**
- ä¸€å€‹åŠŸèƒ½ä¸€å€‹æª”æ¡ˆ
- ä½¿ç”¨æè¿°æ€§æª”å
- ç¶­è­· `docs/README.md` ä½œç‚ºå°è¦½

### 7. `examples/` - ç¯„ä¾‹ ğŸ“

**ç”¨é€”ï¼š** æ•´åˆç¯„ä¾‹å’Œä½¿ç”¨æ¡ˆä¾‹

**å…§å®¹ï¼š**
- Google Apps Script ç¯„ä¾‹
- å®¢æˆ¶ç«¯ä½¿ç”¨ç¯„ä¾‹
- æ¸¬è©¦ç”¨ä¾‹èªªæ˜

### 8. `scripts/` - å·¥å…·è…³æœ¬ ğŸ”§

**ç”¨é€”ï¼š** ç¶­è­·å’Œå·¥å…·è…³æœ¬

**ç¯„ä¾‹ï¼š**
- è³‡æ–™åº«åˆå§‹åŒ–è…³æœ¬
- æ‰¹æ¬¡è™•ç†è…³æœ¬
- æ¸¬è©¦è³‡æ–™ç”¢ç”Ÿå™¨
- éƒ¨ç½²è…³æœ¬

## ğŸ”’ ç‰ˆæœ¬æ§åˆ¶è¦å‰‡

### æ‡‰è©²æäº¤çš„æª”æ¡ˆ âœ…

```
âœ… åŸå§‹ç¢¼ï¼ˆ*.pyï¼‰
âœ… é…ç½®ç¯„æœ¬ï¼ˆ.env.exampleï¼‰
âœ… ä¾è³´æ¸…å–®ï¼ˆrequirements.txtï¼‰
âœ… æ–‡ä»¶ï¼ˆdocs/ï¼‰
âœ… ç¯„ä¾‹ï¼ˆexamples/ï¼‰
âœ… æ¸¬è©¦ç”¨ç¯„ä¾‹æª”æ¡ˆï¼ˆéœ€è„«æ•ï¼‰
âœ… .gitkeepï¼ˆä¿æŒç©ºç›®éŒ„ï¼‰
```

### ä¸æ‡‰æäº¤çš„æª”æ¡ˆ âŒ

```
âŒ è™›æ“¬ç’°å¢ƒï¼ˆvenv/ï¼‰
âŒ ç’°å¢ƒè®Šæ•¸ï¼ˆ.envï¼‰
âŒ ä¸Šå‚³æª”æ¡ˆï¼ˆuploads/*.pdfï¼‰
âŒ çœŸå¯¦è³‡æ–™ï¼ˆdata/ï¼‰
âŒ è¼¸å‡ºçµæœï¼ˆoutput/ï¼‰
âŒ æ—¥èªŒæª”æ¡ˆï¼ˆlogs/ï¼‰
âŒ IDE è¨­å®šï¼ˆ.vscode/, .idea/ï¼‰
âŒ Python å¿«å–ï¼ˆ__pycache__/ï¼‰
âŒ ä½œæ¥­ç³»çµ±æª”æ¡ˆï¼ˆ.DS_Storeï¼‰
```

## ğŸ“ æª”æ¡ˆå‘½åæ…£ä¾‹

### Python æª”æ¡ˆ
```
snake_case.py           # æ¨¡çµ„å’Œè…³æœ¬
ClassName               # é¡åˆ¥åç¨±ï¼ˆåœ¨æª”æ¡ˆä¸­ï¼‰
function_name           # å‡½å¼åç¨±
CONSTANT_NAME           # å¸¸æ•¸
```

### æ¸¬è©¦æª”æ¡ˆ
```
test_*.py              # å–®å…ƒæ¸¬è©¦
*_test.py              # æ›¿ä»£å‘½å
test_files/*.pdf       # æ¸¬è©¦ç”¨ PDF
```

### è³‡æ–™æª”æ¡ˆ
```
{type}_{source}_{date}.{ext}
ç¯„ä¾‹ï¼š
  bank_statement_ctbc_20241119.pdf
  result_bank_20241119.json
  stats_monthly_202411.json
```

### æ–‡ä»¶æª”æ¡ˆ
```
UPPERCASE.md           # é‡è¦æ–‡ä»¶ï¼ˆREADME, CHANGELOGï¼‰
PascalCase.md          # ä¸€èˆ¬æ–‡ä»¶ï¼ˆQuickStart, Deploymentï¼‰
```

## ğŸš€ å¯¦éš›ä½¿ç”¨ç¯„ä¾‹

### é–‹ç™¼æµç¨‹

```bash
# 1. æº–å‚™æ¸¬è©¦æª”æ¡ˆ
cp ~/Downloads/çœŸå¯¦å¸³å–®.pdf test_files/bank_sample.pdf
# æ‰‹å‹•è„«æ•è™•ç†...

# 2. é–‹ç™¼æ¸¬è©¦
python test_pdf_parser.py test_files/bank_sample.pdf --verbose

# 3. å„²å­˜æ¸¬è©¦çµæœ
python test_pdf_parser.py test_files/bank_sample.pdf \
  --output output/test_results/bank_test.json

# 4. æ•´åˆæ¸¬è©¦
python app.py
curl -X POST http://localhost:12345/api/test/parse-pdf \
  -F "file=@test_files/bank_sample.pdf"

# 5. æäº¤ç¨‹å¼ç¢¼ï¼ˆä¸åŒ…å«çœŸå¯¦è³‡æ–™ï¼‰
git add api/ utils/ docs/
git commit -m "feat: æ–°å¢éŠ€è¡Œå°å¸³å–®è§£æ"
```

### ç”Ÿç”¢ç’°å¢ƒ

```bash
# ç’°å¢ƒè®Šæ•¸è¨­å®š
cp .env.example .env
vim .env  # ç·¨è¼¯ç”Ÿç”¢è¨­å®š

# ç¢ºä¿ç›®éŒ„å­˜åœ¨
mkdir -p uploads data logs output

# å•Ÿå‹•æœå‹™
python app.py

# æ—¥èªŒæœƒå¯«å…¥ logs/
# ä¸Šå‚³æª”æ¡ˆæš«å­˜åœ¨ uploads/ï¼ˆè‡ªå‹•æ¸…ç†ï¼‰
# è™•ç†çµæœå¯é¸æ“‡å„²å­˜åˆ° data/
```

## ğŸ§¹ æ¸…ç†å»ºè­°

### å®šæœŸæ¸…ç†ï¼ˆæ‰‹å‹•ï¼‰

```bash
# æ¸…ç†æ¸¬è©¦è¼¸å‡º
rm -rf output/*

# æ¸…ç†èˆŠæ—¥èªŒï¼ˆä¿ç•™æœ€è¿‘ 7 å¤©ï¼‰
find logs/ -name "*.log" -mtime +7 -delete

# æ¸…ç†éºç•™ä¸Šå‚³æª”æ¡ˆ
rm -f uploads/*.pdf
```

### è‡ªå‹•æ¸…ç†ï¼ˆCronï¼‰

```bash
# æ¯å¤©å‡Œæ™¨ 2 é»æ¸…ç†
0 2 * * * find /path/to/task-service/output -mtime +30 -delete
0 2 * * * find /path/to/task-service/logs -name "*.log" -mtime +7 -delete
```

## ğŸ’¡ æœ€ä½³å¯¦è¸

1. **æ¸¬è©¦æª”æ¡ˆç®¡ç†**
   - ä½¿ç”¨ `test_files/` å­˜æ”¾æ‰€æœ‰æ¸¬è©¦ PDF
   - ç¢ºä¿å·²è„«æ•
   - ä¿æŒæª”æ¡ˆå¤§å°åˆç†ï¼ˆ< 5MBï¼‰
   - ä½¿ç”¨æè¿°æ€§å‘½å

2. **è³‡æ–™å„²å­˜**
   - æ•æ„Ÿè³‡æ–™æ”¾åœ¨ `data/`ï¼ˆä¸æäº¤ï¼‰
   - è¨­å®šæª”æ¡ˆæ”¾åœ¨ `data/config/`
   - å®šæœŸå‚™ä»½é‡è¦è³‡æ–™

3. **è¼¸å‡ºç®¡ç†**
   - æ¸¬è©¦çµæœæ”¾åœ¨ `output/`
   - å®šæœŸæ¸…ç†èˆŠæª”æ¡ˆ
   - ä½¿ç”¨æ™‚é–“æˆ³è¨˜å‘½å

4. **æ–‡ä»¶ç¶­è­·**
   - æ–‡ä»¶çµ±ä¸€æ”¾åœ¨ `docs/`
   - ä¿æŒ README ç°¡æ½”
   - è©³ç´°å…§å®¹åˆ†æª”æ¡ˆå­˜æ”¾

5. **ç‰ˆæœ¬æ§åˆ¶**
   - æª¢æŸ¥ `.gitignore` æ˜¯å¦æ­£ç¢º
   - ä¸æäº¤æ•æ„Ÿè³‡æ–™
   - æäº¤å‰æª¢æŸ¥æª”æ¡ˆæ¸…å–®

---

**è¨˜ä½**ï¼šæŠŠå°çš„æª”æ¡ˆæ”¾åœ¨å°çš„åœ°æ–¹ï¼Œå°ˆæ¡ˆæ‰èƒ½ä¿æŒæ•´æ½”å’Œå®‰å…¨ï¼ğŸ¯

